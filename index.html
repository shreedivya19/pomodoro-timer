<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lofi Anime Study Timer ðŸŽµ</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            background: linear-gradient(135deg, 
                #1a1a2e 0%, 
                #16213e 25%, 
                #0f3460 50%, 
                #533483 75%, 
                #7209b7 100%);
            min-height: 100vh;
            position: relative;
            overflow-x: hidden;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        /* Animated background particles */
        .particle {
            position: absolute;
            border-radius: 50%;
            background: rgba(255, 179, 217, 0.1);
            animation: float-particle linear infinite;
            pointer-events: none;
        }

        @keyframes float-particle {
            0% {
                transform: translateY(100vh) scale(0);
                opacity: 0;
            }
            10% {
                opacity: 1;
            }
            90% {
                opacity: 1;
            }
            100% {
                transform: translateY(-100vh) scale(1);
                opacity: 0;
            }
        }

        /* Animated sakura petals */
        .sakura {
            position: absolute;
            width: 8px;
            height: 8px;
            background: linear-gradient(45deg, #ffb3d9, #ff8cc8);
            border-radius: 50% 0;
            transform: rotate(45deg);
            animation: sakura-fall linear infinite;
            opacity: 0.7;
        }

        @keyframes sakura-fall {
            0% {
                transform: translateY(-100vh) rotate(0deg);
                opacity: 1;
            }
            100% {
                transform: translateY(100vh) rotate(360deg);
                opacity: 0;
            }
        }

        /* Floating music notes */
        .music-note {
            position: absolute;
            color: rgba(255, 179, 217, 0.6);
            font-size: 18px;
            animation: float-note 8s ease-in-out infinite;
            pointer-events: none;
        }

        @keyframes float-note {
            0%, 100% { 
                transform: translateY(0) rotate(0deg); 
                opacity: 0.3; 
            }
            50% { 
                transform: translateY(-30px) rotate(15deg); 
                opacity: 0.8; 
            }
        }

        /* Main container with glassmorphism */
        .container {
            background: rgba(20, 20, 40, 0.95);
            backdrop-filter: blur(25px);
            border-radius: 30px;
            padding: 40px;
            box-shadow: 
                0 25px 50px rgba(0, 0, 0, 0.4),
                0 0 0 1px rgba(255, 179, 217, 0.1),
                inset 0 1px 0 rgba(255, 255, 255, 0.1);
            text-align: center;
            max-width: 500px;
            width: 90%;
            position: relative;
            z-index: 10;
            border: 2px solid rgba(255, 179, 217, 0.2);
        }

        /* Anime character silhouette decoration */
        .character-decoration {
            position: absolute;
            top: -30px;
            right: -15px;
            width: 80px;
            height: 80px;
            background: linear-gradient(45deg, rgba(255, 140, 200, 0.3), rgba(114, 9, 183, 0.3));
            clip-path: polygon(50% 0%, 83% 25%, 83% 75%, 50% 100%, 17% 75%, 17% 25%);
            animation: glow-pulse 4s ease-in-out infinite;
        }

        @keyframes glow-pulse {
            0%, 100% { 
                opacity: 0.3;
                transform: scale(1);
            }
            50% { 
                opacity: 0.6;
                transform: scale(1.1);
            }
        }

        .study-title {
            color: #ffb3d9;
            font-size: 1.8rem;
            font-weight: 700;
            margin-bottom: 8px;
            text-shadow: 0 0 20px rgba(255, 179, 217, 0.6);
            letter-spacing: 1px;
        }

        .study-subtitle {
            color: rgba(255, 255, 255, 0.8);
            font-size: 1rem;
            margin-bottom: 30px;
            font-style: italic;
            font-weight: 300;
        }

        .mode-tabs {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin-bottom: 25px;
            background: rgba(0, 0, 0, 0.2);
            border-radius: 25px;
            padding: 5px;
        }

        .mode-tab {
            background: transparent;
            border: none;
            border-radius: 20px;
            padding: 10px 20px;
            color: rgba(255, 255, 255, 0.6);
            font-size: 0.9rem;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .mode-tab::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 179, 217, 0.3), transparent);
            transition: left 0.5s ease;
        }

        .mode-tab:hover::before {
            left: 100%;
        }

        .mode-tab.active {
            background: rgba(255, 140, 200, 0.3);
            color: white;
            font-weight: 600;
            box-shadow: 0 0 20px rgba(255, 140, 200, 0.4);
        }

        .mode-indicator {
            font-size: 1.2rem;
            color: #ffb3d9;
            margin-bottom: 25px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 2px;
            position: relative;
        }

        .mode-indicator::before,
        .mode-indicator::after {
            content: "â™«";
            position: absolute;
            top: 50%;
            transform: translateY(-50%);
            color: rgba(255, 179, 217, 0.5);
            font-size: 1rem;
            animation: note-dance 3s ease-in-out infinite;
        }

        .mode-indicator::before { 
            left: -30px;
            animation-delay: 0s;
        }
        .mode-indicator::after { 
            right: -30px;
            animation-delay: 1s;
        }

        @keyframes note-dance {
            0%, 100% { transform: translateY(-50%) scale(1); }
            50% { transform: translateY(-60%) scale(1.2); }
        }

        /* Vinyl record progress indicator */
        .vinyl-container {
            position: relative;
            width: 180px;
            height: 180px;
            margin: 25px auto;
        }

        .vinyl-record {
            width: 100%;
            height: 100%;
            background: 
                radial-gradient(circle at center, 
                    transparent 12%, 
                    #2d2d2d 12%, 
                    #2d2d2d 15%, 
                    #1a1a1a 15%, 
                    #1a1a1a 20%, 
                    #2d2d2d 20%, 
                    #2d2d2d 85%, 
                    #1a1a1a 85%);
            border-radius: 50%;
            position: relative;
            animation: vinyl-spin 8s linear infinite;
            box-shadow: 
                0 0 30px rgba(0, 0, 0, 0.5),
                inset 0 0 20px rgba(0, 0, 0, 0.3);
        }

        .vinyl-record.paused {
            animation-play-state: paused;
        }

        .vinyl-center {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 30px;
            height: 30px;
            background: radial-gradient(circle, #ff8cc8, #e91e63);
            border-radius: 50%;
            box-shadow: 
                inset 0 2px 5px rgba(0, 0, 0, 0.3),
                0 0 15px rgba(255, 140, 200, 0.5);
        }

        .vinyl-center::after {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 8px;
            height: 8px;
            background: rgba(0, 0, 0, 0.5);
            border-radius: 50%;
        }

        .vinyl-arm {
            position: absolute;
            top: 15px;
            right: 25px;
            width: 4px;
            height: 90px;
            background: linear-gradient(to bottom, #c0c0c0, #808080);
            border-radius: 2px;
            transform-origin: top center;
            animation: arm-sway 8s ease-in-out infinite;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.3);
        }

        .vinyl-arm.paused {
            animation-play-state: paused;
        }

        @keyframes vinyl-spin {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }

        @keyframes arm-sway {
            0%, 100% { transform: rotate(28deg); }
            50% { transform: rotate(25deg); }
        }

        /* Progress ring overlay */
        .progress-ring {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
        }

        .progress-ring svg {
            width: 100%;
            height: 100%;
            transform: rotate(-90deg);
        }

        .progress-ring-circle {
            fill: none;
            stroke-width: 3;
            stroke-linecap: round;
        }

        .progress-ring-bg {
            stroke: rgba(255, 179, 217, 0.2);
        }

        .progress-ring-progress {
            stroke: #ff8cc8;
            stroke-dasharray: 530;
            stroke-dashoffset: 530;
            transition: stroke-dashoffset 1s ease;
            filter: drop-shadow(0 0 8px rgba(255, 140, 200, 0.8));
        }

        .timer-display {
            font-size: 4.2rem;
            font-weight: 200;
            color: #ffffff;
            margin: 25px 0;
            text-shadow: 
                0 0 30px rgba(255, 179, 217, 0.7),
                0 0 60px rgba(255, 140, 200, 0.4);
            letter-spacing: 4px;
            font-variant-numeric: tabular-nums;
        }

        .controls {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin: 30px 0;
        }

        .btn {
            background: rgba(255, 179, 217, 0.1);
            border: 1px solid rgba(255, 179, 217, 0.3);
            border-radius: 50px;
            padding: 14px 28px;
            color: white;
            font-size: 0.95rem;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            display: flex;
            align-items: center;
            gap: 8px;
            position: relative;
            overflow: hidden;
        }

        .btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 179, 217, 0.3), transparent);
            transition: left 0.6s ease;
        }

        .btn:hover::before {
            left: 100%;
        }

        .btn:hover {
            background: rgba(255, 140, 200, 0.2);
            border-color: #ff8cc8;
            transform: translateY(-2px);
            box-shadow: 
                0 10px 25px rgba(255, 140, 200, 0.3),
                0 0 20px rgba(255, 140, 200, 0.2);
        }

        .btn:active {
            transform: translateY(0);
        }

        .btn-primary {
            background: rgba(255, 140, 200, 0.4);
            border-color: #ff8cc8;
            box-shadow: 0 0 20px rgba(255, 140, 200, 0.4);
        }

        .btn-primary:hover {
            background: rgba(255, 140, 200, 0.5);
            box-shadow: 
                0 15px 30px rgba(255, 140, 200, 0.4),
                0 0 30px rgba(255, 140, 200, 0.3);
        }

        /* Enhanced music player */
        .music-player {
            background: rgba(0, 0, 0, 0.4);
            backdrop-filter: blur(15px);
            border-radius: 20px;
            padding: 20px;
            margin-top: 25px;
            border: 1px solid rgba(255, 179, 217, 0.2);
            box-shadow: inset 0 1px 0 rgba(255, 255, 255, 0.1);
        }

        .now-playing {
            color: #ffb3d9;
            font-size: 1rem;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            font-weight: 500;
        }

        .now-playing i {
            animation: music-pulse 2s ease-in-out infinite;
        }

        @keyframes music-pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.2); }
        }

        .music-title {
            color: white;
            font-size: 0.9rem;
            margin-bottom: 15px;
            font-weight: 400;
            min-height: 20px;
        }

        .music-controls {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 20px;
            margin-bottom: 15px;
        }

        .music-btn {
            background: rgba(255, 179, 217, 0.1);
            border: 1px solid rgba(255, 179, 217, 0.3);
            border-radius: 50%;
            width: 40px;
            height: 40px;
            color: rgba(255, 179, 217, 0.8);
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .music-btn:hover {
            color: #ff8cc8;
            background: rgba(255, 140, 200, 0.2);
            border-color: #ff8cc8;
            transform: scale(1.1);
            box-shadow: 0 5px 15px rgba(255, 140, 200, 0.3);
        }

        .music-btn.play-btn {
            width: 50px;
            height: 50px;
            font-size: 1.2rem;
            background: rgba(255, 140, 200, 0.2);
            border-color: #ff8cc8;
        }

        .volume-slider {
            display: flex;
            align-items: center;
            gap: 10px;
            justify-content: center;
        }

        .volume-control {
            width: 120px;
            height: 6px;
            background: rgba(255, 179, 217, 0.3);
            border-radius: 3px;
            outline: none;
            cursor: pointer;
            appearance: none;
        }

        .volume-control::-webkit-slider-thumb {
            appearance: none;
            width: 18px;
            height: 18px;
            background: linear-gradient(45deg, #ff8cc8, #e91e63);
            border-radius: 50%;
            cursor: pointer;
            box-shadow: 0 2px 10px rgba(255, 140, 200, 0.5);
        }

        .volume-control::-moz-range-thumb {
            width: 18px;
            height: 18px;
            background: linear-gradient(45deg, #ff8cc8, #e91e63);
            border-radius: 50%;
            cursor: pointer;
            border: none;
        }

        /* Statistics panel */
        .stats {
            display: flex;
            justify-content: space-around;
            margin-top: 25px;
            padding-top: 20px;
            border-top: 1px solid rgba(255, 179, 217, 0.2);
        }

        .stat {
            text-align: center;
            position: relative;
        }

        .stat-number {
            font-size: 1.4rem;
            font-weight: 700;
            color: #ffb3d9;
            display: block;
            text-shadow: 0 0 15px rgba(255, 179, 217, 0.6);
        }

        .stat-label {
            font-size: 0.75rem;
            color: rgba(255, 255, 255, 0.7);
            margin-top: 4px;
            text-transform: uppercase;
            letter-spacing: 1px;
            font-weight: 500;
        }

        /* Enhanced notifications */
        .notification {
            position: fixed;
            top: 25px;
            right: 25px;
            background: rgba(20, 20, 40, 0.95);
            backdrop-filter: blur(20px);
            color: white;
            padding: 18px 25px;
            border-radius: 15px;
            border: 1px solid rgba(255, 179, 217, 0.3);
            transform: translateX(450px);
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            z-index: 1000;
            box-shadow: 
                0 15px 35px rgba(0, 0, 0, 0.3),
                0 0 20px rgba(255, 140, 200, 0.2);
            max-width: 300px;
            font-size: 0.9rem;
            line-height: 1.4;
        }

        .notification.show {
            transform: translateX(0);
        }

        /* Break mode styling */
        .break-mode {
            background: linear-gradient(135deg, 
                #1a2e1a 0%, 
                #213e16 25%, 
                #34600f 50%, 
                #488333 75%, 
                #09b720 100%);
        }

        .break-mode .progress-ring-progress {
            stroke: #4ecdc4;
            filter: drop-shadow(0 0 8px rgba(78, 205, 196, 0.8));
        }

        .break-mode .vinyl-center {
            background: radial-gradient(circle, #4ecdc4, #26a69a);
            box-shadow: 
                inset 0 2px 5px rgba(0, 0, 0, 0.3),
                0 0 15px rgba(78, 205, 196, 0.5);
        }

        .break-mode .mode-indicator::before,
        .break-mode .mode-indicator::after {
            color: rgba(78, 205, 196, 0.5);
        }

        /* Responsive design */
        @media (max-width: 600px) {
            .container {
                padding: 30px 25px;
                margin: 15px;
                max-width: 95%;
            }
            
            .timer-display {
                font-size: 3.2rem;
            }
            
            .controls {
                flex-direction: column;
                align-items: center;
            }
            
            .btn {
                width: 100%;
                max-width: 220px;
                justify-content: center;
            }
            
            .character-decoration {
                display: none;
            }
            
            .vinyl-container {
                width: 150px;
                height: 150px;
            }
        }

        @media (max-width: 400px) {
            .study-title {
                font-size: 1.4rem;
            }
            
            .timer-display {
                font-size: 2.8rem;
                letter-spacing: 2px;
            }
            
            .mode-tabs {
                gap: 5px;
            }
            
            .mode-tab {
                padding: 8px 12px;
                font-size: 0.8rem;
            }
        }

        /* Focus mode animations */
        .timer-running .vinyl-record {
            animation-duration: 4s;
        }

        .timer-running .timer-display {
            animation: focus-glow 3s ease-in-out infinite;
        }

        .timer-running .vinyl-center {
            animation: center-glow 2s ease-in-out infinite;
        }

        @keyframes focus-glow {
            0%, 100% { 
                text-shadow: 
                    0 0 30px rgba(255, 179, 217, 0.7),
                    0 0 60px rgba(255, 140, 200, 0.4);
            }
            50% { 
                text-shadow: 
                    0 0 40px rgba(255, 179, 217, 0.9),
                    0 0 80px rgba(255, 140, 200, 0.6);
            }
        }

        @keyframes center-glow {
            0%, 100% { 
                box-shadow: 
                    inset 0 2px 5px rgba(0, 0, 0, 0.3),
                    0 0 15px rgba(255, 140, 200, 0.5);
            }
            50% { 
                box-shadow: 
                    inset 0 2px 5px rgba(0, 0, 0, 0.3),
                    0 0 25px rgba(255, 140, 200, 0.8);
            }
        }

        /* Loading animation */
        .loading {
            opacity: 0;
            animation: fadeIn 1s ease-out forwards;
        }

        @keyframes fadeIn {
            to { opacity: 1; }
        }
    </style>
</head>
<body>
    <!-- Animated background elements -->
    <div class="particle" style="left: 5%; animation-duration: 20s; animation-delay: 0s; width: 4px; height: 4px;"></div>
    <div class="particle" style="left: 15%; animation-duration: 25s; animation-delay: 5s; width: 6px; height: 6px;"></div>
    <div class="particle" style="left: 25%; animation-duration: 18s; animation-delay: 2s; width: 3px; height: 3px;"></div>
    <div class="particle" style="left: 45%; animation-duration: 22s; animation-delay: 8s; width: 5px; height: 5px;"></div>
    <div class="particle" style="left: 65%; animation-duration: 19s; animation-delay: 3s; width: 4px; height: 4px;"></div>
    <div class="particle" style="left: 75%; animation-duration: 24s; animation-delay: 7s; width: 7px; height: 7px;"></div>
    <div class="particle" style="left: 85%; animation-duration: 21s; animation-delay: 4s; width: 5px; height: 5px;"></div>
    <div class="particle" style="left: 95%; animation-duration: 16s; animation-delay: 6s; width: 3px; height: 3px;"></div>

    <!-- Animated sakura petals -->
    <div class="sakura" style="left: 10%; animation-duration: 15s; animation-delay: 0s;"></div>
    <div class="sakura" style="left: 20%; animation-duration: 18s; animation-delay: 2s;"></div>
    <div class="sakura" style="left: 30%; animation-duration: 12s; animation-delay: 4s;"></div>
    <div class="sakura" style="left: 50%; animation-duration: 16s; animation-delay: 1s;"></div>
    <div class="sakura" style="left: 70%; animation-duration: 14s; animation-delay: 3s;"></div>
    <div class="sakura" style="left: 80%; animation-duration: 20s; animation-delay: 5s;"></div>
    <div class="sakura" style="left: 90%; animation-duration: 17s; animation-delay: 2.5s;"></div>

    <!-- Floating music notes -->
    <div class="music-note" style="top: 15%; left: 12%; animation-delay: 0s;">â™ª</div>
    <div class="music-note" style="top: 35%; left: 88%; animation-delay: 2s;">â™«</div>
    <div class="music-note" style="top: 55%; left: 8%; animation-delay: 4s;">â™ª</div>
    <div class="music-note" style="top: 75%; left: 85%; animation-delay: 6s;">â™«</div>
    <div class="music-note" style="top: 25%; left: 50%; animation-delay: 1s;">â™ª</div>
    <div class="music-note" style="top: 65%; left: 45%; animation-delay: 3s;">â™«</div>
    
    <div class="container loading" id="container">
        <div class="character-decoration"></div>
        
        <div class="study-title">ðŸŒ¸ Lofi Study Session</div>
        <div class="study-subtitle">Focus with chill beats & anime vibes âœ¨</div>
        
        <div class="mode-tabs">
            <button class="mode-tab active" data-mode="pomodoro">
                <i class="fas fa-brain" style="margin-right: 5px;"></i>
                Focus
            </button>
            <button class="mode-tab" data-mode="short-break">
                <i class="fas fa-coffee" style="margin-right: 5px;"></i>
                Chill
            </button>
            <button class="mode-tab" data-mode="long-break">
                <i class="fas fa-bed" style="margin-right: 5px;"></i>
                Rest
            </button>
        </div>
        
        <div class="mode-indicator" id="modeIndicator">Study Time</div>
        
        <div class="vinyl-container">
            <div class="vinyl-record paused" id="vinylRecord">
                <div class="vinyl-center"></div>
            </div>
            <div class="vinyl-arm paused" id="vinylArm"></div>
            <div class="progress-ring">
                <svg>
                    <circle class="progress-ring-circle progress-ring-bg" cx="90" cy="90" r="84"></circle>
                    <circle class="progress-ring-circle progress-ring-progress" cx="90" cy="90" r="84" id="progressCircle"></circle>
                </svg>
            </div>
        </div>
        
        <div class="timer-display" id="timerDisplay">25:00</div>
        
        <div class="controls">
            <button class="btn btn-primary" id="startBtn">
                <i class="fas fa-play"></i>
                Start Focus
            </button>
            <button class="btn" id="pauseBtn" style="display: none;">
                <i class="fas fa-pause"></i>
                Pause
            </button>
            <button class="btn" id="resetBtn">
                <i class="fas fa-refresh"></i>
                Reset
            </button>
        </div>

        <div class="music-player">
            <div class="now-playing">
                <i class="fas fa-music"></i>
                Now Playing
            </div>
            <div class="music-title" id="musicTitle">Lofi Hip Hop - Study Beats</div>
            <div class="music-controls">
                <button class="music-btn" id="volumeBtn" title="Mute/Unmute">
                    <i class="fas fa-volume-up"></i>
                </button>
            </div>
            <div class="volume-slider">
                <i class="fas fa-volume-down" style="color: rgba(255, 179, 217, 0.6);"></i>
                <input type="range" class="volume-control" id="volumeControl" min="0" max="100" value="50">
                <i class="fas fa-volume-up" style="color: rgba(255, 179, 217, 0.6);"></i>
            </div>
        </div>

        <div class="stats">
            <div class="stat">
                <span class="stat-number" id="sessionsCompleted">0</span>
                <span class="stat-label">Sessions</span>
            </div>
            <div class="stat">
                <span class="stat-number" id="totalFocusTime">0h</span>
                <span class="stat-label">Focus Time</span>
            </div>
            <div class="stat">
                <span class="stat-number" id="currentStreak">0</span>
                <span class="stat-label">Streak</span>
            </div>
        </div>
    </div>

    <!-- Notification element -->
    <div class="notification" id="notification"></div>

    <script>
        class PomodoroTimer {
            constructor() {
                this.modes = {
                    pomodoro: { duration: 25 * 60, label: 'Study Time' },
                    'short-break': { duration: 5 * 60, label: 'Short Break' },
                    'long-break': { duration: 15 * 60, label: 'Long Break' }
                };
                
                this.currentMode = 'pomodoro';
                this.timeLeft = this.modes[this.currentMode].duration;
                this.totalTime = this.timeLeft;
                this.isRunning = false;
                this.interval = null;
                this.audio = null;
                this.musicPlaylists = [
                    'Lofi Hip Hop - Study Beats',
                    'Chill Anime Soundtrack',
                    'Peaceful Rain & Piano',
                    'Tokyo CafÃ© Ambience',
                    'Sakura Dreams',
                    'Midnight Study Session'
                ];
                this.currentTrack = 0;
                this.stats = {
                    sessions: 0,
                    totalTime: 0,
                    streak: 0
                };
                
                this.init();
                this.loadStats();
            }
            
            init() {
                this.bindEvents();
                this.updateDisplay();
                this.updateMusicTitle();
                this.createAudioContext();
                
                // Load initial state
                setTimeout(() => {
                    document.getElementById('container').classList.remove('loading');
                }, 500);
            }
            
            createAudioContext() {
                // Create a simple audio context for background music simulation
                try {
                    this.audioContext = new (window.AudioContext || window.webkitAudioContext)();
                    this.oscillator = null;
                    this.gainNode = this.audioContext.createGain();
                    this.gainNode.connect(this.audioContext.destination);
                    this.gainNode.gain.setValueAtTime(0.3, this.audioContext.currentTime);
                } catch (error) {
                    console.log('Audio context not supported');
                }
            }
            
            playBackgroundMusic() {
                if (!this.audioContext) return;
                
                try {
                    if (this.oscillator) {
                        this.oscillator.stop();
                    }
                    
                    this.oscillator = this.audioContext.createOscillator();
                    this.oscillator.connect(this.gainNode);
                    this.oscillator.type = 'sine';
                    
                    // Create a simple lofi-style chord progression
                    const frequencies = [220, 246.94, 261.63, 293.66]; // A, B, C, D
                    let currentFreq = 0;
                    
                    const changeFreq = () => {
                        if (this.oscillator && this.audioContext) {
                            this.oscillator.frequency.setValueAtTime(
                                frequencies[currentFreq], 
                                this.audioContext.currentTime
                            );
                            currentFreq = (currentFreq + 1) % frequencies.length;
                        }
                    };
                    
                    this.oscillator.start();
                    changeFreq();
                    
                    // Change frequency every 2 seconds for a simple melody
                    this.musicInterval = setInterval(changeFreq, 2000);
                    
                } catch (error) {
                    console.log('Audio playback failed');
                }
            }
            
            stopBackgroundMusic() {
                if (this.oscillator) {
                    this.oscillator.stop();
                    this.oscillator = null;
                }
                if (this.musicInterval) {
                    clearInterval(this.musicInterval);
                }
            }
            
            bindEvents() {
                // Timer controls
                document.getElementById('startBtn').addEventListener('click', () => this.start());
                document.getElementById('pauseBtn').addEventListener('click', () => this.pause());
                document.getElementById('resetBtn').addEventListener('click', () => this.reset());
                
                // Mode tabs
                document.querySelectorAll('.mode-tab').forEach(tab => {
                    tab.addEventListener('click', () => this.switchMode(tab.dataset.mode));
                });
                
                // Music controls
                document.getElementById('playMusic').addEventListener('click', () => this.toggleMusic());
                document.getElementById('nextTrack').addEventListener('click', () => this.nextTrack());
                document.getElementById('prevTrack').addEventListener('click', () => this.prevTrack());
                document.getElementById('volumeBtn').addEventListener('click', () => this.toggleMute());
                document.getElementById('volumeControl').addEventListener('input', (e) => this.setVolume(e.target.value));
                
                // Keyboard shortcuts
                document.addEventListener('keydown', (e) => {
                    if (e.code === 'Space' && e.target.tagName !== 'BUTTON') {
                        e.preventDefault();
                        this.isRunning ? this.pause() : this.start();
                    }
                });
            }
            
            start() {
                if (this.audioContext && this.audioContext.state === 'suspended') {
                    this.audioContext.resume();
                }
                
                this.isRunning = true;
                this.interval = setInterval(() => this.tick(), 1000);
                
                // Update UI
                document.getElementById('startBtn').style.display = 'none';
                document.getElementById('pauseBtn').style.display = 'flex';
                
                // Add running animation
                document.getElementById('container').classList.add('timer-running');
                document.getElementById('vinylRecord').classList.remove('paused');
                document.getElementById('vinylArm').classList.remove('paused');
                
                this.showNotification('Timer started! Stay focused! ðŸŽµ');
            }
            
            pause() {
                this.isRunning = false;
                if (this.interval) {
                    clearInterval(this.interval);
                }
                
                // Update UI
                document.getElementById('startBtn').style.display = 'flex';
                document.getElementById('pauseBtn').style.display = 'none';
                
                // Remove running animation
                document.getElementById('container').classList.remove('timer-running');
                document.getElementById('vinylRecord').classList.add('paused');
                document.getElementById('vinylArm').classList.add('paused');
                
                this.showNotification('Timer paused');
            }
            
            reset() {
                this.pause();
                this.timeLeft = this.modes[this.currentMode].duration;
                this.totalTime = this.timeLeft;
                this.updateDisplay();
                this.updateProgress();
                this.showNotification('Timer reset');
            }
            
            tick() {
                if (this.timeLeft > 0) {
                    this.timeLeft--;
                    this.updateDisplay();
                    this.updateProgress();
                } else {
                    this.complete();
                }
            }
            
            complete() {
                this.pause();
                
                // Update stats
                if (this.currentMode === 'pomodoro') {
                    this.stats.sessions++;
                    this.stats.totalTime += this.modes.pomodoro.duration;
                    this.stats.streak++;
                } else {
                    // Reset streak if break is skipped
                    this.stats.streak = Math.max(0, this.stats.streak);
                }
                
                this.saveStats();
                this.updateStats();
                
                // Show completion notification
                const messages = {
                    pomodoro: 'Great work! Time for a break! ðŸŽ‰',
                    'short-break': 'Break complete! Ready to focus? ðŸ’ª',
                    'long-break': 'Long break done! Let\'s get back to work! ðŸš€'
                };
                
                this.showNotification(messages[this.currentMode]);
                
                // Auto-switch to next mode
                setTimeout(() => {
                    if (this.currentMode === 'pomodoro') {
                        this.switchMode(this.stats.sessions % 4 === 0 ? 'long-break' : 'short-break');
                    } else {
                        this.switchMode('pomodoro');
                    }
                }, 2000);
            }
            
            switchMode(mode) {
                this.currentMode = mode;
                this.timeLeft = this.modes[mode].duration;
                this.totalTime = this.timeLeft;
                
                // Update UI
                document.querySelectorAll('.mode-tab').forEach(tab => {
                    tab.classList.remove('active');
                });
                document.querySelector(`[data-mode="${mode}"]`).classList.add('active');
                
                document.getElementById('modeIndicator').textContent = this.modes[mode].label;
                
                // Update theme for break modes
                if (mode.includes('break')) {
                    document.body.classList.add('break-mode');
                } else {
                    document.body.classList.remove('break-mode');
                }
                
                this.updateDisplay();
                this.updateProgress();
                this.pause();
            }
            
            updateDisplay() {
                const minutes = Math.floor(this.timeLeft / 60);
                const seconds = this.timeLeft % 60;
                document.getElementById('timerDisplay').textContent = 
                    `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
            }
            
            updateProgress() {
                const progressPercent = ((this.totalTime - this.timeLeft) / this.totalTime) * 100;
                const circumference = 2 * Math.PI * 84; // radius = 84
                const offset = circumference - (progressPercent / 100) * circumference;
                
                document.getElementById('progressCircle').style.strokeDashoffset = offset;
            }
            
            // Music player functions
            toggleMusic() {
                const playBtn = document.getElementById('playMusic');
                const icon = playBtn.querySelector('i');
                
                if (icon.classList.contains('fa-play')) {
                    icon.classList.remove('fa-play');
                    icon.classList.add('fa-pause');
                    this.playBackgroundMusic();
                    this.showNotification(`Playing: ${this.musicPlaylists[this.currentTrack]}`);
                } else {
                    icon.classList.remove('fa-pause');
                    icon.classList.add('fa-play');
                    this.stopBackgroundMusic();
                    this.showNotification('Music paused');
                }
            }
            
            nextTrack() {
                this.currentTrack = (this.currentTrack + 1) % this.musicPlaylists.length;
                this.updateMusicTitle();
                this.showNotification(`Next: ${this.musicPlaylists[this.currentTrack]}`);
                
                // If music is playing, restart with new track
                const playBtn = document.getElementById('playMusic');
                if (playBtn.querySelector('i').classList.contains('fa-pause')) {
                    this.stopBackgroundMusic();
                    setTimeout(() => this.playBackgroundMusic(), 100);
                }
            }
            
            prevTrack() {
                this.currentTrack = this.currentTrack === 0 ? 
                    this.musicPlaylists.length - 1 : this.currentTrack - 1;
                this.updateMusicTitle();
                this.showNotification(`Previous: ${this.musicPlaylists[this.currentTrack]}`);
                
                // If music is playing, restart with new track
                const playBtn = document.getElementById('playMusic');
                if (playBtn.querySelector('i').classList.contains('fa-pause')) {
                    this.stopBackgroundMusic();
                    setTimeout(() => this.playBackgroundMusic(), 100);
                }
            }
            
            updateMusicTitle() {
                document.getElementById('musicTitle').textContent = this.musicPlaylists[this.currentTrack];
            }
            
            toggleMute() {
                const volumeBtn = document.getElementById('volumeBtn');
                const volumeControl = document.getElementById('volumeControl');
                const icon = volumeBtn.querySelector('i');
                
                if (icon.classList.contains('fa-volume-up') || icon.classList.contains('fa-volume-down')) {
                    icon.className = 'fas fa-volume-mute';
                    this.previousVolume = volumeControl.value;
                    volumeControl.value = 0;
                    this.setVolume(0);
                } else {
                    icon.className = 'fas fa-volume-up';
                    volumeControl.value = this.previousVolume || 50;
                    this.setVolume(volumeControl.value);
                }
            }
            
            setVolume(value) {
                if (this.gainNode) {
                    this.gainNode.gain.setValueAtTime(value / 100 * 0.3, this.audioContext.currentTime);
                }
                
                const volumeBtn = document.getElementById('volumeBtn');
                const icon = volumeBtn.querySelector('i');
                
                if (value == 0) {
                    icon.className = 'fas fa-volume-mute';
                } else if (value < 50) {
                    icon.className = 'fas fa-volume-down';
                } else {
                    icon.className = 'fas fa-volume-up';
                }
            }
            
            // Statistics functions
            updateStats() {
                document.getElementById('sessionsCompleted').textContent = this.stats.sessions;
                document.getElementById('totalFocusTime').textContent = 
                    `${Math.floor(this.stats.totalTime / 3600)}h`;
                document.getElementById('currentStreak').textContent = this.stats.streak;
            }
            
            saveStats() {
                const statsData = JSON.stringify(this.stats);
                // Since we can't use localStorage, we'll just keep stats in memory for this session
                this.savedStats = statsData;
            }
            
            loadStats() {
                // Since we can't use localStorage, start with default stats
                this.updateStats();
            }
            
            // Notification system
            showNotification(message) {
                const notification = document.getElementById('notification');
                notification.textContent = message;
                notification.classList.add('show');
                
                setTimeout(() => {
                    notification.classList.remove('show');
                }, 3000);
            }
        }
        
        // Initialize the timer when DOM is loaded
        document.addEventListener('DOMContentLoaded', () => {
            new PomodoroTimer();
        });
        
        // Add some extra visual effects
        function createFloatingElement() {
            const elements = ['â™ª', 'â™«', 'ðŸŒ¸', 'âœ¨'];
            const element = document.createElement('div');
            element.textContent = elements[Math.floor(Math.random() * elements.length)];
            element.style.cssText = `
                position: fixed;
                left: ${Math.random() * 100}%;
                top: 100%;
                color: rgba(255, 179, 217, 0.6);
                font-size: ${12 + Math.random() * 8}px;
                pointer-events: none;
                z-index: 1;
                animation: float-up 8s ease-out forwards;
            `;
            
            document.body.appendChild(element);
            
            setTimeout(() => {
                element.remove();
            }, 8000);
        }
        
        // Create floating elements periodically
        setInterval(createFloatingElement, 3000);
        
        // Add the float-up animation
        const style = document.createElement('style');
        style.textContent = `
            @keyframes float-up {
                0% {
                    transform: translateY(0) rotate(0deg);
                    opacity: 0;
                }
                10% {
                    opacity: 1;
                }
                90% {
                    opacity: 1;
                }
                100% {
                    transform: translateY(-100vh) rotate(360deg);
                    opacity: 0;
                }
            }
        `;
        document.head.appendChild(style);
    </script>
</body>
</html>
<button class="music-btn" id="previousTrack" title="Previous Track">
                    <i class="fas fa-step-backward"></i>
                    </button>
                <button class="music-btn play-btn" id="playMusic" title="Play/Pause Music">
                    <i class="fas fa-play"></i>
                </button>
                <button class="music-btn" id="nextTrack" title="Next Track">
                    <i class="fas fa-step-forward"></i>
                </button>
                